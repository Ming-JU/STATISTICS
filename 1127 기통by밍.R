# dice data ---------------------------------------------------------------

dice <- c(3,3,5,3,6,2,4,1,5,3,
          4,5,6,2,3,1,2,5,6,3, 
          2,5,4,6,1,2,5,3,6,1, 
          2,4,6,3,4,1,5,6,1,4, 
          2,3,6,1,3,4,1,2,3,4, 
          5,2,6,5,4,1,3,2,4,5, 
          2,3,4,2,1,6,5,1,3,4, 
          5,3,2,4,5,1,6,3,4,5, 
          2,6,4,3,5,1,2,6,2,3, 
          4,5,6,1,2,3,1,5,1,4, 
          6,2,5,3,4,5,1,2,3,5, 
          6,2,3,4,1,6,5,1,4,2, 
          5,6,2,3,1,4,5,3,4,2, 
          3,6,1,2,3,1,4,5,4,6, 
          3,4,1,5,4,2,1,6,1,2, 
          3,6,4,1,2,3,4,1,5,6, 
          3,4,5,2,3,6,4,1,5,6, 
          2,3,4,5,2,4,5,6,2,3, 
          1,5,4,3,4,2,6,5,1,2, 
          4,5,6,2,3,1,5,6,3,4, 
          1,6,5,1,4,2,6,5,3,4, 
          1,4,6,3,4,5,1,6,3,1, 
          5,2,3,6,4,6,4,1,6,3, 
          4,5,6,2,1,6,5,4,3,5, 
          1,1,4,2,5,3,4,1,6,3, 
          1,6,5,3,5,2,6,1,2,6, 
          4,1,3,5,1,2,6,3,4,2, 
          1,2,6,4,5,4,1,5,3,6, 
          2,3,5,1,6,1,5,3,6,2, 
          4,1,5,2,6,3,4,2,6,3, 
          1,3,2,1,6,3,5,2,6,3, 
          5,2,6,5,3,6,5,3,1,4, 
          2,6,4,5,3,5,2,6,1,2, 
          5,2,3,4,6,5,3,2,4,4)



# (1) ---------------------------------------------------------------------
o <- table(dice)
o
p = c(1, 1, 1, 1, 1, 1)/6

e = p*sum(o)
d = (o - e)**2/e
chisq0 = sum(d)
pvalue = 1-pchisq(chisq0, 5)
print(pvalue)

# 2 ----------------------------------------
n <- length(dice)
dice_df <- data.frame(x1 = dice[1:n-1], x2 = dice[2:n])
o <- table(dice_df)

o
dice_df = data.frame(x1 = dice[1:n-1],x2 = dice[2:n])
o = table(dice_df)


namelist = list(c("1","2","3","4","5","6"), c("1","2","3","4","5","6"))
row_sum = apply(o, 1, sum)
col_sum = apply(o, 2, sum)

e = row_sum %*% t(col_sum)/sum(o)

dimnames(e) = namelist

d = (o-e)**2/e
chisq0 = sum(d)

alpha = 0.05

df = (length(row_sum) - 1) * (length(col_sum) - 1)
chisq_alpha = qchisq(1 - alpha, df)
print(c(chisq0, chisq_alpha))

pvalue = 1 - pchisq(chisq0, df)
pvalue
